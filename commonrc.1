# vim: set filetype=zsh :

# for setting history length see HISTSIZE and HISTFILESIZE in bash(1)
HISTSIZE=1000000
# bash only
HISTFILESIZE=1000000
# zsh only
SAVEHIST=1000000

export TERM="xterm-256color"

# colored GCC warnings and errors
#export GCC_COLORS='error=01;31:warning=01;35:note=01;36:caret=01;32:locus=01:quote=01'

# some more ls aliases
alias ll='ls -alF'
alias la='ls -A'
alias l='ls -CF'
if $( hash gnome-open 2>/dev/null ) || $( hash xdg-open 2>/dev/null ); then
    alias open='gnome-open 2>/dev/null'
    alias pbcopy='xsel --clipboard --input'
    alias pbpaste='xsel --clipboard --output'
fi

alias p='$(fc -ln -1)'
mkcd () {
    mkdir "$1"
    cd "$1"
}

alias gits='git status -s'
. ~/opt/z/z.sh

for includedir in /usr/local/bin $HOME/opt/thinkpad $HOME/opt /opt $HOME/.cabal/bin $HOME/node_modules/bin; do
    if [ -e $includedir ]; then
        export PATH=$PATH:$includedir
    fi
done

RVM_VERSION=2.1.1
if [[ -s "$HOME/.rvm/scripts/rvm" ]] ; then
    source "$HOME/.rvm/scripts/rvm" ;
    export PATH="$PATH:~/.rvm/gems/ruby-$RVM_VERSION/bin:$HOME/.rvm/bin"
    rvm use ruby-$RVM_VERSION
fi

# # ref http://d.hatena.ne.jp/dame-p/20110313/1299992080
export JAVA_OPTS="-Dswank.encoding=utf-8-unix" # 日本語用？
# export JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64
_JAVA_AWT_WM_NONREPARENTING=1; export _JAVA_AWT_WM_NONREPARENTING

### export HAXE_LIBRARY_PATH=/usr/lib/haxe/std:. # the ':.' part is important
### export HAXE_HOME=/usr/lib/haxe
### export NEKOPATH=/usr/lib/neko
### PATH=$PATH:$HAXE_LIBRARY_PATH:$HAXE_HOME


RUNLOG=rr.log
function rr {
    if [ $# -eq 0 ]; then
        LASTCMD=$(fc -ln -1)
        echo 'commit last command:'
        echo $LASTCMD
        echo $LASTCMD >> $RUNLOG
    else
        echo $@ >> $RUNLOG
        $@
    fi
}

export GOPATH=~/gopath

if ! type "npm" > /dev/null; then
    :
else
    export NODE_PATH=$(npm root -g)
fi


if [ -e /opt/android-sdk-linux/tools ]; then
    export PATH=$PATH:/opt/android-sdk-linux/tools
fi

stty stop undef # unmap ctrl-s for vim-ipython

# BOOT option
# BOOT_JVM_OPTIONS="-client -XX:+TieredCompilation -XX:TieredStopAtLevel=1 -Xmx2g -XX:MaxPermSize=128m -XX:+UseConcMarkSweepGC -XX:+CMSClassUnloadingEnabled -Xverify:none"
alias ssh-nosave='ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -C -X'
alias scp-nosave='scp -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -C'
alias mosh-nosave='mosh --ssh=-"o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -C -X"'

NIX_SH_PATH=$HOME/.nix-profile/etc/profile.d/nix.sh
if [ -e $NIX_SH_PATH ]; then
    unset LD_LIBRARY_PATH
    unset LD_PRELOAD
    . $NIX_SH_PATH;
    alias nsh=nix-shell
fi


## keychain
if type keychain >/dev/null ; then
    # this from commonrc.1
    # keychain --eval id_rsa
    # this from original bashrc
    # one of the methods is probably obsolete
    keychain ~/.ssh/id_rsa
    . ~/.keychain/`uname -n`-sh
fi


if [ $TILIX_ID ] || [ $VTE_VERSION ]; then
    source /etc/profile.d/vte.sh
fi
